# 开发相关工具及常用命令

阿里云源配置官网：http://mirrors.aliyun.com/

**源配置步骤**

```bash
#备份
sudo mv /etc/yum.repos.d/CentOS-Base.repo /etc/yum.repos.d/CentOS-Base.repo.backup
#下载ContOS-Base.repo 到 /etc/yum.repos.d/
wget -O /etc/yum.repos.d/CentOs-Base.repo http://mirrors.aliyun.com/repo/Centos-6.repo
#运行yun makecache生成缓存
```



## Tomcat

#### Tomcat简介

Tomcat是一个web容器， JavaEE程序可以在此运行。

#### Tomcat安装

Tomcat7

在安装Tomcat之前需要安装好jdk

**安装步骤**

```shell
#下载
wget http://learning.happymmall.com/tomcat/apache-tomcat-7.0.73.tar.gz
#解压缩
tar -zxvf ./apache-tomcat-7.0.73.tar.gz
#设置UTF-8字符集，修改tomcat中conf文件夹里面的server.xml，找到配置8080端口的位置，在xml节点末尾添加URIEncoding="UTF-8"
cd ./apache-tomcat-7.0.73
sudo vim ./conf/server.xml
#配置环境变量
sudo vim /etc/profile
export CATALINA_HOME -> source /etc/profile
sudo source /etc/profile
source /etc/profile
#启动
cd ./bin/
./startup.sh
#关闭
./shutdown.sh
```

### Maven项目构建与管理工具安装讲解

#### Maven简介

Maven是Java项目的构建和管理工具

+ 用Maven可以方便的创建项目，基于archtype可以创建多种类型的Java项目
+ Maven仓库对jar包（artifact）进行统一管理，避免jar文件的重复拷贝和版本冲突
+ 团队开发，Maven管理项目的RELEASE和SNAPSHOT版本，方便多模块（Module）项目的各个模块之间的快速集成

#### Maven安装

版本：3.0.5

**安装步骤**

```shell
#下载
wget https://mirrors.tuna.tsinghua.edu.cn/apache/maven/maven-3/3.0.5/binaries/apache-maven-3.0.5-bin.tar.gz
#解压缩
tar -zxvf apache-maven-3.0.5-bin.tar.gz
#配置环境变量
sudo vim /etc/profile
export MAVEN_HOME=/home/ylf/apache-maven-3.0.5
export PATH=$JAVA_HOME/bin:$PATH:$MAVEN_HOME/bin
source /etc/profile
#测试
mvn -version
```

### vsftpd

#### vsftpd简介

“very secure FTP daemon”的缩写， 是一个完全免费的、开源FTP服务器软件。

特点：小巧轻快、安全易用、支持虚拟用户、支持带宽限制等功能

#### vsftpd安装

版本：vsftpd-2.2.2-21.el6.x86_64

**安装步骤**

```shell
#安装
yum -y install vsftpd
#rpm -qa| grep vsftpd 检查是否已经安装vsftpd
#默认配置文件在/etc/vsftpd/vsftpd.conf

#创建虚拟用户
#选择在根或者用户目录下创建ftp文件夹
mkdir ftpfile
#添加匿名用户，nologin意味着不能登陆
sudo useradd ftpuser -d /home/ftpfile -s /sbin/nologin
#修改ftpfile权限
sudo chown -R ftpuser.ftpuser /home/ftpfile
#重设ftpuser密码，123456
sudo passwd ftpuser

#vsftpd配置
cd /etc/vsftpd/
sudo vim chroot_list
#添加ftpuser进入chroot_list
sudo vim /etc/selinux/config
#修改SELINUX为disabled
#如果一会验证的时候碰到550拒绝访问执行：sudo setsebool -P ftp_home_dir 1
#重启Linux服务器

#服务器配置
sudo vim /etc/vsftpd/vsftpd.conf
#本项目用到的配置项参见http://learning.happymmall.com/vsftpdconfig/vsftpd.conf.readme.html

#防火墙配置
sudo vim /etc/sysconfig/iptables
#将以下配置添加到防火墙配置中
#vsftpd
-A INPUT -p TCP --dport 61001:62000 -j ACCEPT
-A OUTPUT -p TCP --sport 61001:62000 -j ACCEPT
-A INPUT -p TCP --dport 20 -j ACCEPT
-A OUTPUT -p TCP --sport 20 -j ACCEPT
-A INPUT -p TCP --dport 21 -j ACCEPT
-A OUTPUT -p TCP --sport 21 -j ACCEPT
#重启防火墙
sudo service iptables restart

#vsftpd验证
sudo service vsftpd restart
#第一次启动时Shutting down vsftpd是failed不用理会
#浏览器访问：ftp://yourip,用户名ftpuser，密码123456
```



| 本项目中使用到的vsftpd配置项                        |
| ---------------------------------------- |
| local_root=/ftpfile(当本地用户登入时，将被更换到定义的目录下，默认值为各用户的家目录) |
| anon_root=/ftpfile(使用匿名登入时，所登入的目录)       |
| use_localtime=YES(默认是GMT时间，改成使用本机系统时间)   |
| anonymous_enable=NO(不允许匿名用户登录)           |
| local_enable=YES(允许本地用户登录)               |
| write_enable=YES(本地用户可以在自己家目录中进行读写操作)    |
| local_umask=022(本地用户新增档案时的umask值)        |
| dirmessage_enable=YES(如果启动这个选项，那么使用者第一次进入一个目录时，会检查该目录下是否有.message这个档案，如果有，则会出现此档案的内容，通常这个档案会放置欢迎话语，或是对该目录的说明。默认值为开启) |
| xferlog_enable=YES(是否启用上传/下载日志记录。如果启用，则上传与下载的信息将被完整纪录在xferlog_file 所定义的档案中。预设为开启。) |
| connect_from_port_20=YES(指定FTP使用20端口进行数据传输，默认值为YES) |
| xferlog_std_format=YES(如果启用，则日志文件将会写成xferlog的标准格式) |
| ftpd_banner=Welcome to mmall FTP Server(这里用来定义欢迎话语的字符串) |
| chroot_local_user=NO(用于指定用户列表文件中的用户是否允许切换到上级目录) |
| chroot_list_enable=YES(设置是否启用chroot_list_file配置项指定的用户列表文件) |
| chroot_list_file=/etc/vsftpd/chroot_list(用于指定用户列表文件) |
| listen=YES(设置vsftpd服务器是否以standalone模式运行，以standalone模式运行是一种较好的方式，此时listen必须设置为YES，此为默认值。建议不要更改，有很多与服务器运行相关的配置命令，需要在此模式下才有效，若设置为NO，则vsftpd不是以独立的服务运行，要受到xinetd服务的管控，功能上会受到限制) |
| pam_service_name=vsftpd(虚拟用户使用PAM认证方式，这里是设置PAM使用的名称，默认即可，与/etc/pam.d/vsftpd对应) userlist_enable=YES(是否启用vsftpd.user_list文件，黑名单,白名单都可以 |
| pasv_min_port=61001(被动模式使用端口范围最小值)       |
| pasv_max_port=62000(被动模式使用端口范围最大值)       |
| pasv_enable=YES pasv_enable=YES/NO（YES）若设置为YES，则使用PASV工作模式；若设置为NO，则使用PORT模式。默认值为YES，即使用PASV工作模式。 |

FTP协议有两种工作方式：PORT方式和PASV方式，中文意思为主动式和被动式。

+ PORT（主动）方式的连接过程是：客户端向服务器的FTP端口（默认是21）发送连接请求，服务器接受连接，建立一条命令链路。 

   当需要传送数据时，客户端在命令链路上用 PORT命令告诉服务器：“我打开了端口，你过来连接我”。于是服务器从20端口向客户端的端口发送连接请求，建立一条数据链路来传送数据。

+ PASV（被动）方式的连接过程是：客户端向服务器的FTP端口（默认是21）发送连接请求，服务器接受连接，建立一条命令链路。 

  当需要传送数据时，服务器在命令链路上用 PASV命令告诉客户端：“我打开了端口，你过来连接我”。于是客户端向服务器的端口发送连接请求，建立一条数据链路来传送数据。 

从上面可以看出，两种方式的命令链路连接方法是一样的，而数据链路的建立方法就完全不同。而FTP的复杂性就在于此。

### Nginx

#### Nginx简介

Nginx是一款轻量级Web服务器，也是一款反向代理服务器。

可以直接支持Rails和PHP的服务、可作为HTTP反向代理服务器、负载均衡服务器、邮件代理服务器、帮助实现前端动静分离。

特点：高稳定、高性能、占用资源少、功能丰富、模块化结构、支持热部署。

### Nginx安装

版本：1.10.2

**安装步骤**

```shell
#安装gcc,通过输入gcc -v看系统是否自带安装
yum install gcc
#安装pcre
yum install pcre-devel
#安装zlib
yum install zlib zlib-devel
#安装openssl
yum install openssl openssl-devel

#下载源码包
wget http://nginx.org/download/nginx-1.10.2.tar.gz
#解压
tar -zxvf nginx-1.10.2.tar.gz

#nginx安装,进入目录
./configure
#可以指定安装目录--prefix=/usr/nginx，默认安装在/usr/local/nginx
make
make install
```

#### Nginx常用命令

```shell
#测试配置文件
./nginx/sbin/nginx -t
#启动命令
./nginx/sbin/nginx
#停止命令
./nginx/sbin/nginx -s stop
#或
nginx -s quit
#重启命令
./nginx/sbin/nginx -s reload
#查看进程命令
ps -ef| grep nginx
#平滑重启
kill -HUP [nginx主进程号]
#增加防火墙访问权限
-A INPUT -p tcp -m state -- state NEW -m tcp --dport 80 -j ACCEPT
```

#### Nginx虚拟域名配置及测试验证

**配置步骤**

```shell
sudo vim /usr/local/nginx/conf/nginx.conf
#添加
include vhost/*.conf;
#http://learning.happymmall.com/nginx/linux_conf/nginx.conf

#新建vhost 文件夹
mkdir /usr/local/nginx/conf/vhost
#创建域名转发配置文件，点击查看详情
#http://learning.happymmall.com/nginx/linux_conf/vhost/learning.happymmall.com.conf
#http://learning.happymmall.com/nginx/linux_conf/vhost/happymmall.com.conf
#http://learning.happymmall.com/nginx/linux_conf/vhost/img.happymmall.com.conf
#http://learning.happymmall.com/nginx/linux_conf/vhost/s.happymmall.com.conf


#访问验证
#使用默认80端口访问验证
```

**配置文件样例**
```
server { 
	listen 80; 
	autoindex on; 
	server_name www.rmall.com; 
	access_log /usr/local/nginx/logs/access.log combined; 
	index index.html index.htm index.jsp index.php; 
	#error_page 404 /404.html; 
	if ( $query_string ~* ".*[\;'\<\>].*" ){ 
		return 404;
	} 
	location / { 
		proxy_pass http://127.0.0.1:8080; 
		#访问文件的情况下，上面可改成：root /product/img/
		add_header Access-Control-Allow-Origin *; 
	} 
}
```



**注意事项**

+ 可以配置域名转发，但一定要配置host，并且是host生效后才可以，设置完成之后要重启浏览器

  ```shell
  sudo vim /etc/hosts
  #添加好对应的域名及IP
  ```


### MySQL数据库安装与配置

#### MySQL简介

关系型数据库，由瑞典MySQL AB公司开发，目前属于Oracle旗下产品

**特点：**双授权政策，分为社区版和商业版，体积小、速度快、总体拥有成本第、开源

#### MySQL安装

版本：mysql-server-5.1.73

**安装步骤**

```shell
#安装
yum -y install mysql-server
#检测是否已安装
rpm -qa| grep mysql-server

#默认配置文件在/etc/my.cnf
#字符集配置
vim /etc/my.cnf
#在【mysqld】节点下添加：
default-character-set=utf8
character-set-server=utf8

#自启动设置
chkconfig mysqld on
chkconfig --list mysqld
#如果2-5位为on状态即ok

#防火墙配置
-A INPUT -p tcp -m tcp --dport 3306 -j ACCEPT

#启动mysqld服务
service mysqld start
#或
/ect/rc.d/init.d/mysqld start

#MySQL初始化环境设置
#因为未设置密码，执行
mysql -u root
#登陆MySQL服务器


#MySQL配置
#查看目前mysql用户
select user,host,password from mysql.user
#修改root密码
set password for root@localhost=password('yourpassword');
#或
set password for root@127.0.0.1=password('yourpassword');
#之后重新登陆要输入密码
mysql -u root -p

#删除匿名用户
select user,host from mysql.user;
delete from mysql.user where user='';
select user,host from mysql.user;
#刷新，使以上操作生效
flush privileges;

#插入mysql新用户
insert into mysql.user(Host,User,Password) values ("localhost","yourusername", password("yourpassword"));
#刷新，使以上操作生效
flush privileges;
#创建新的database
CREATE DATABASE `rmall` DEFAULT CHARACTER SET utf8 COLLATE utf8_general_ci;

#本地用户赋予所有权限
grant all privileges on rmall.* to yourusername@localhost identified by 'yourpassword'
#给账号开通外网所有权限
grant all privileges on rmall.* to 'yourusername'@'%' identified by 'yourpassword'
#也可以根据自己实际情况决定是否开什么权限,如
grant select,insert on rmall.* to 'yourusername'@'192.168.2.1' identified by 'yourpassword'
#刷新，使以上操作生效
flush privileges;

#可以通过客户端连接，例如
```

**常用命令**

```shell
sudo service mysqld start
sudo service mysqld stop
sudo service mysqld restart
```

**权限**

+ dql - select
+ dml - insert update delete 
+ ddl - create table create view 
+ dcl - grant

### git

#### git简介

免费开源的分布式版本控制系统。

#### git安装

版本：2.8.0

**安装步骤**

```shell

#安装依赖
sudo yum -y install zlib-devel openssl-devel cpio expat-devel gettext-devel curl-devel perl-ExtUtils-CBuilder perl-ExtUtils-MakeMaker

wget https://github.com/git/git/archive/v2.8.0.tar.gz
tar -zxvf ./v2.8.0.tar.gz
cd git-2.8.0/

#安装
sudo make prefix=/usr/local all
sudo make prefix=/usr/local install

git --version
```

**基础配置**

```shell
#配置用户名
git config --global user.name "rushay"
#配置邮箱
git config --global user.email "lfyangyang@outlook.com"
#其它配置
git config --global merge.tool "kdiff3"
#没装KDiff3就不用设这一行
git config --global core.autocrlf false
#让Git不要管Windows/Unix换行符转换的事
```

**编码配置**

```shell
git config --global gui.encoding utf-8
#避免git gui中的中文乱码
git config --global core.quotepath off
#避免git status显示的中文文件名乱码
```

**git ssh key pair的配置**

```shell
ssh-keygen -t rsa -C "lfyangyang@outlook.com"
#一路回车不输入任何密码，生成ssh key pair
ssh-add ~/.ssh/id_rsa
cat ~/.ssh/id_rsa.pub
#把公钥内容复制到剪切板
```

公钥：

ssh-rsa AAAAB3NzaC1yc2EAAAABIwAAAQEA7EjMAF3VW55SGayQKCn05+a3d1uIJUEHFcBQhqeIY+SX8Bqqxi70j+gzaKZ58g81+tCY+Z1ybjfhzm44M9Qbe+eshHLHMrYhZWEdiPDtasxGv/j3VreG0yTLJjErAECTjL3dbXbkuEZWieU4kzXuRg53tndyQ09KRH3JXyYgHU+H3wshUaWWiL3nQL+CF+QXxkCHIyqJGyM8hiCqsBL+nAGhdDZnL0Fn8hIVeWXfYyE65/v/ckev36prqviTgx1L9Rw4YdwGpAL/4BSQW4NdMjKo2hBtuSqOWghh4r0dBHCxCowUKODl/iOkxy3gxy6CShDftZLm4Qw63g8ZscLQRw== lfyangyang@outlook.com

#### git常用命令

```shell
#切换分支
git checkout 分支名
#拉取
git pull
#提交
git push
```

