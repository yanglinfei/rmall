# 订单模块

### 功能介绍

前台功能： 创建订单、商品信息、订单列表、订单详情、取消订单

后台功能： 订单列表、订单搜索、订单详情、订单发货

### 功能特点

- 对业务逻辑中横向越权和纵向越权等安全漏洞处理
- 使用安全、扩展性强大的常量、枚举类
- 订单号生成规则
- POJP和VO之间对象转换

### 数据表设计

#### 订单表

| rmall_order  | 类型     |
| ------------ | -------- |
| id           | int      |
| order_no     | bigint   |
| user_id      | int      |
| shipping_id  | int      |
| payment      | decimal  |
| payment_type | int      |
| postage      | int      |
| status       | int      |
| payment_time | datetime |
| send_time    | datetime |
| end_time     | datetime |
| close_time   | datetime |
| create_time  | datetime |
| update_time  | datetime |

#### 订单明细表

| rmall_order_item   | 类型     |
| ------------------ | -------- |
| id                 | int      |
| user_id            | int      |
| order_no           | bigint   |
| product_id         | int      |
| product_name       | varchar  |
| product_image      | varchar  |
| current_unit_price | decimal  |
| quantity           | int      |
| total_price        | decimal  |
| create_time        | datetime |
| update_time        | datetime |

### 接口设计

**商品管理部分**

/manage/order路径下

1. 订单列表

   /list.do

   ```java
   ServerResponse<PageInfo> orderList(HttpSession session, @RequestParam(value = "pageNum",defaultValue = "1") int pageNum, @RequestParam(value = "pageSize",defaultValue = "10") int pageSize)
   ```

2. 订单详情

   /detail.do

   ```java
   ServerResponse<OrderVo> orderList(HttpSession session, Long orderNo)
   ```


3. 订单查找

   /search.do

   ```java
   ServerResponse<PageInfo> orderList(HttpSession session, @RequestParam(value = "pageNum",defaultValue = "1") int pageNum, @RequestParam(value = "pageSize",defaultValue = "10") int pageSize)
   ```

4. 订单发货

   /send_goods.do

   ```java
   ServerResponse<String> orderSendGoods(HttpSession session, Long orderNo)
   ```

**用户部分**

/order路径下

1. 订单创建

   /create.do

   ```java
   ServerResponse<OrderVo> create(HttpSession session, Integer shippingId)
   ```

2. 订单取消

   /cancel.do

   ```java
   ServerResponse cancel(HttpSession session, Long orderNo)
   ```


3. 获取购物车选中商品

   /get_order_cart_product.do

   ```java
   ServerResponse getOrderCartProduct(HttpSession session)
   ```

4. 订单详情

   /detail.do

   ```java
   ServerResponse detail(HttpSession session, Long orderNo)
   ```

5. 订单列表

   /list.do

   ```java
   ServerResponse detail(HttpSession session, @RequestParam(value = "pageNum",defaultValue = "1") int pageNum, @RequestParam(value = "pageSize",defaultValue = "10") int pageSize)
   ```


